<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShamanAI - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ò–ò –ê–≥–µ–Ω—Ç</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
    <script src="https://unpkg.com/tesseract.js@4.1.1/dist/tesseract.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjs@11.8.0/lib/browser/math.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.min.js"></script>
    <style>
        :root {
            --neon-purple: #8A2BE2;
            --neon-cyan: #00CED1;
            --neon-pink: #FF1493;
            --matrix-green: #00FF41;
            --dark-bg: #0a0a0a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }

        body {
            background: var(--dark-bg);
            color: var(--neon-cyan);
            overflow-x: hidden;
            min-height: 100vh;
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 2px solid var(--neon-purple);
            margin-bottom: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 3em;
            color: var(--neon-purple);
            text-shadow: 0 0 10px var(--neon-purple);
            animation: glow 2s ease-in-out infinite alternate;
        }

        .header p {
            color: var(--neon-cyan);
            font-size: 1.2em;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
            margin-bottom: 30px;
        }

        .chat-container {
            background: rgba(10, 10, 10, 0.8);
            border: 1px solid var(--neon-purple);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.3);
        }

        .chat-messages {
            height: 500px;
            overflow-y: auto;
            padding: 15px;
            border: 1px solid var(--neon-cyan);
            border-radius: 10px;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.5);
        }

        .message {
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 10px;
            animation: fadeIn 0.3s ease-in;
        }

        .user-message {
            background: rgba(0, 206, 209, 0.2);
            border-left: 3px solid var(--neon-cyan);
            text-align: right;
        }

        .ai-message {
            background: rgba(138, 43, 226, 0.2);
            border-left: 3px solid var(--neon-purple);
        }

        .input-area {
            display: flex;
            gap: 10px;
        }

        .input-area textarea {
            flex: 1;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid var(--neon-pink);
            border-radius: 8px;
            padding: 12px;
            color: white;
            resize: vertical;
            min-height: 60px;
        }

        .input-area button {
            background: var(--neon-pink);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .input-area button:hover {
            background: #ff1ca6;
            box-shadow: 0 0 15px var(--neon-pink);
        }

        .tools-panel {
            background: rgba(10, 10, 10, 0.8);
            border: 1px solid var(--neon-cyan);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .tool-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid var(--matrix-green);
            border-radius: 10px;
        }

        .tool-section h3 {
            color: var(--matrix-green);
            margin-bottom: 10px;
        }

        .upload-area {
            border: 2px dashed var(--neon-cyan);
            padding: 20px;
            text-align: center;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: var(--neon-pink);
            background: rgba(255, 20, 147, 0.1);
        }

        .graph-container {
            width: 100%;
            height: 200px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            margin-top: 10px;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px var(--neon-purple); }
            to { text-shadow: 0 0 20px var(--neon-purple), 0 0 30px var(--neon-purple); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .typing-indicator {
            display: none;
            color: var(--neon-pink);
            font-style: italic;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="matrix-bg" id="matrixCanvas"></div>
    
    <div class="container">
        <div class="header">
            <h1>ShamanAI</h1>
            <p>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ò–ò –∞–≥–µ–Ω—Ç —Å –ø–æ–ª–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º</p>
        </div>

        <div class="main-content">
            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="message ai-message">
                        <strong>ShamanAI:</strong> –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –Ø –≤–∞—à –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ò–ò –ø–æ–º–æ—â–Ω–∏–∫. –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã, –∑–∞–≥—Ä—É–∂–∞–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Ä–µ—à–∞–π—Ç–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫–∏.
                    </div>
                </div>
                
                <div class="typing-indicator" id="typingIndicator">
                    ShamanAI –ø–µ—á–∞—Ç–∞–µ—Ç...
                </div>
                
                <div class="input-area">
                    <textarea id="userInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ..."></textarea>
                    <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
                
                <div style="margin-top: 15px; text-align: center;">
                    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                        üìÅ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    </div>
                    <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="handleImageUpload(this.files[0])">
                </div>
            </div>

            <div class="tools-panel">
                <div class="tool-section">
                    <h3>üîÆ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ—à–∞—Ç–µ–ª—å</h3>
                    <input type="text" id="mathInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: 2*x + 5 = 15" style="width: 100%; padding: 8px; margin-bottom: 10px; background: rgba(0,0,0,0.7); color: white; border: 1px solid var(--neon-cyan); border-radius: 5px;">
                    <button onclick="solveMath()" style="width: 100%; padding: 8px; background: var(--neon-purple); color: white; border: none; border-radius: 5px; cursor: pointer;">–†–µ—à–∏—Ç—å</button>
                </div>

                <div class="tool-section">
                    <h3>üìä –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –≥—Ä–∞—Ñ–∏–∫–æ–≤</h3>
                    <input type="text" id="graphInput" placeholder="–§—É–Ω–∫—Ü–∏—è: x^2 + 2*x + 1" style="width: 100%; padding: 8px; margin-bottom: 10px; background: rgba(0,0,0,0.7); color: white; border: 1px solid var(--neon-cyan); border-radius: 5px;">
                    <button onclick="plotGraph()" style="width: 100%; padding: 8px; background: var(--neon-pink); color: white; border: none; border-radius: 5px; cursor: pointer;">–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫</button>
                    <div class="graph-container">
                        <canvas id="graphCanvas"></canvas>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>‚ö° –§–∏–∑–∏—á–µ—Å–∫–∏–π –¥–≤–∏–∂–æ–∫</h3>
                    <select id="physicsSelect" style="width: 100%; padding: 8px; margin-bottom: 10px; background: rgba(0,0,0,0.7); color: white; border: 1px solid var(--neon-cyan); border-radius: 5px;">
                        <option value="kinematic">–ö–∏–Ω–µ–º–∞—Ç–∏–∫–∞</option>
                        <option value="dynamics">–î–∏–Ω–∞–º–∏–∫–∞</option>
                        <option value="energy">–≠–Ω–µ—Ä–≥–∏—è</option>
                        <option value="electro">–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ</option>
                    </select>
                    <button onclick="physicsCalculate()" style="width: 100%; padding: 8px; background: var(--matrix-green); color: black; border: none; border-radius: 5px; cursor: pointer;">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º
        class ShamanAI {
            constructor() {
                this.memory = JSON.parse(localStorage.getItem('shaman_memory')) || {
                    conversations: [],
                    preferences: {},
                    learnedPatterns: []
                };
                this.isInitialized = false;
                this.init();
            }

            async init() {
                await this.loadTFModel();
                this.isInitialized = true;
                this.addMessage("–°–∏—Å—Ç–µ–º–∞ ShamanAI –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞. –í—Å–µ –º–æ–¥—É–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã.", "ai");
            }

            async loadTFModel() {
                try {
                    // –ü—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
                    this.model = await tf.loadLayersModel('https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_0.25_224/model.json');
                } catch (error) {
                    console.log("TF –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ");
                }
            }

            async processInput(input, type = 'text') {
                if (!this.isInitialized) {
                    return "–°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...";
                }

                switch (type) {
                    case 'text':
                        return await this.processText(input);
                    case 'image':
                        return await this.processImage(input);
                    case 'math':
                        return await this.processMath(input);
                    case 'physics':
                        return await this.processPhysics(input);
                    default:
                        return await this.processText(input);
                }
            }

            async processText(input) {
                // –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–≤–µ—Ç–æ–≤ ShamanAI
                const responses = {
                    '–ø—Ä–∏–≤–µ—Ç': ['–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?', '–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é! –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã.', '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ ShamanAI!'],
                    '–∫–∞–∫ –¥–µ–ª–∞': ['–§—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ!', '–í –ø–æ–ª–Ω–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Ä–∞–±–æ—Ç–µ!', '–û—Ç–ª–∏—á–Ω–æ! –ì–æ—Ç–æ–≤ —Ä–µ—à–∞—Ç—å –≤–∞—à–∏ –∑–∞–¥–∞—á–∏!'],
                    '—Å–ø–∞—Å–∏–±–æ': ['–í—Å–µ–≥–¥–∞ –∫ –≤–∞—à–∏–º —É—Å–ª—É–≥–∞–º!', '–†–∞–¥ –±—ã–ª –ø–æ–º–æ—á—å!', '–û–±—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è!'],
                    '–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞': ['–ì–æ—Ç–æ–≤ —Ä–µ—à–∞—Ç—å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏!', '–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!'],
                    '—Ñ–∏–∑–∏–∫–∞': ['–§–∏–∑–∏—á–µ—Å–∫–∏–π –¥–≤–∏–∂–æ–∫ –∑–∞–ø—É—â–µ–Ω!', '–ì–æ—Ç–æ–≤ –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º —Ä–∞—Å—á–µ—Ç–∞–º!'],
                    '–≥—Ä–∞—Ñ–∏–∫': ['–ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!', '–ì–æ—Ç–æ–≤ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏!']
                };

                input = input.toLowerCase();
                
                // –ü–æ–∏—Å–∫ —Ç–æ—á–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
                for (const [key, answers] of Object.entries(responses)) {
                    if (input.includes(key)) {
                        return answers[Math.floor(Math.random() * answers.length)];
                    }
                }

                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
                if (input.includes('?')) {
                    const answerTypes = [
                        `–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –≤–∞—à–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞, —è –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å —á—Ç–æ —ç—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è.`,
                        `–ú–æ–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞—Å–ø–µ–∫—Ç–æ–≤ —ç—Ç–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞...`,
                        `–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—è –≤–∞—à –≤–æ–ø—Ä–æ—Å —Å —Ä–∞–∑–Ω—ã—Ö —Ç–æ—á–µ–∫ –∑—Ä–µ–Ω–∏—è...`,
                        `–ò—Å—Ö–æ–¥—è –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤...`
                    ];
                    return answerTypes[Math.floor(Math.random() * answerTypes.length)] + 
                           " –ú–æ–≥—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.";
                }

                // –û—Ç–≤–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                return "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å! –Ø –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª –µ–≥–æ –∏ –≥–æ—Ç–æ–≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–ª–∏ —Ä–µ—à–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É.";
            }

            async processImage(file) {
                try {
                    const worker = await Tesseract.createWorker('rus+eng');
                    await worker.initialize();
                    const { data: { text } } = await worker.recognize(file);
                    await worker.terminate();
                    
                    return `üì∑ –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω:\n\n–¢–µ–∫—Å—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏: "${text}"\n\n–ì–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π!`;
                } catch (error) {
                    return "–û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π.";
                }
            }

            async processMath(expression) {
                try {
                    const result = math.evaluate(expression);
                    const steps = this.generateMathSteps(expression, result);
                    return `üßÆ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ:\n\n–í—ã—Ä–∞–∂–µ–Ω–∏–µ: ${expression}\n–†–µ–∑—É–ª—å—Ç–∞—Ç: ${result}\n\n–ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ:\n${steps}`;
                } catch (error) {
                    return "–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–µ—à–∏—Ç—å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å.";
                }
            }

            generateMathSteps(expression, result) {
                const steps = [
                    `1. –ê–Ω–∞–ª–∏–∑ –≤—ã—Ä–∞–∂–µ–Ω–∏—è: ${expression}`,
                    `2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª`,
                    `3. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π`,
                    `4. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: ${result}`,
                    `5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è`
                ];
                return steps.join('\n');
            }

            async processPhysics(params) {
                const formulas = {
                    kinematic: {
                        description: "–ö–∏–Ω–µ–º–∞—Ç–∏–∫–∞: –¥–≤–∏–∂–µ–Ω–∏–µ —Ç–µ–ª",
                        formula: "v = v0 + a*t",
                        example: "v = 10 + 2*5 = 20 –º/—Å"
                    },
                    dynamics: {
                        description: "–î–∏–Ω–∞–º–∏–∫–∞: —Å–∏–ª—ã –∏ –¥–≤–∏–∂–µ–Ω–∏–µ", 
                        formula: "F = m*a",
                        example: "F = 5*2 = 10 –ù"
                    },
                    energy: {
                        description: "–≠–Ω–µ—Ä–≥–∏—è: –∫–∏–Ω–µ—Ç–∏—á–µ—Å–∫–∞—è –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è",
                        formula: "E = m*g*h + (m*v¬≤)/2",
                        example: "E = 2*9.8*10 + (2*5¬≤)/2 = 246 –î–∂"
                    },
                    electro: {
                        description: "–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ: –∑–∞–∫–æ–Ω –û–º–∞",
                        formula: "I = U/R", 
                        example: "I = 220/100 = 2.2 –ê"
                    }
                };

                const topic = params.topic || 'kinematic';
                const data = formulas[topic];
                
                return `‚ö° –§–∏–∑–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç (${data.description}):\n\n–§–æ—Ä–º—É–ª–∞: ${data.formula}\n–ü—Ä–∏–º–µ—Ä: ${data.example}\n\n–ì–æ—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞—Å—á–µ—Ç —Å –≤–∞—à–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏!`;
            }

            addMessage(content, type) {
                const message = {
                    content,
                    type,
                    timestamp: new Date().toISOString()
                };
                this.memory.conversations.push(message);
                this.saveMemory();
                return message;
            }

            saveMemory() {
                localStorage.setItem('shaman_memory', JSON.stringify(this.memory));
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ShamanAI
        const shamanAI = new ShamanAI();

        // –ú–∞—Ç—Ä–∏—á–Ω—ã–π —Ñ–æ–Ω
        function initMatrix() {
            const canvas = document.getElementById('matrixCanvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const chars = "01010101010101010101010101010101010101010101010101010101010101010101010101010101";
            const charArray = chars.split("");
            const fontSize = 14;
            const columns = canvas.width / fontSize;
            const drops = [];
            
            for(let i = 0; i < columns; i++) {
                drops[i] = 1;
            }
            
            function draw() {
                ctx.fillStyle = "rgba(10, 10, 10, 0.04)";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = "#00FF41";
                ctx.font = fontSize + "px monospace";
                
                for(let i = 0; i < drops.length; i++) {
                    const text = charArray[Math.floor(Math.random() * charArray.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    if(drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
            }
            
            setInterval(draw, 33);
        }

        // –§—É–Ω–∫—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function addMessageToChat(content, type) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}-message`;
            messageDiv.innerHTML = `<strong>${type === 'user' ? '–í—ã' : 'ShamanAI'}:</strong> ${content.replace(/\n/g, '<br>')}`;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            addMessageToChat(text, 'user');
            input.value = '';
            
            document.getElementById('typingIndicator').style.display = 'block';
            
            setTimeout(async () => {
                const response = await shamanAI.processText(text);
                document.getElementById('typingIndicator').style.display = 'none';
                addMessageToChat(response, 'ai');
                shamanAI.addMessage(response, 'ai');
            }, 1000 + Math.random() * 2000);
        }

        async function handleImageUpload(file) {
            if (!file) return;
            
            addMessageToChat(`üì∑ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ${file.name}`, 'user');
            document.getElementById('typingIndicator').style.display = 'block';
            
            const response = await shamanAI.processImage(file);
            document.getElementById('typingIndicator').style.display = 'none';
            addMessageToChat(response, 'ai');
        }

        function solveMath() {
            const input = document.getElementById('mathInput').value.trim();
            if (!input) return;
            
            addMessageToChat(`üßÆ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞: ${input}`, 'user');
            document.getElementById('typingIndicator').style.display = 'block';
            
            setTimeout(() => {
                const response = shamanAI.processMath(input);
                document.getElementById('typingIndicator').style.display = 'none';
                addMessageToChat(response, 'ai');
            }, 1000);
        }

        function plotGraph() {
            const input = document.getElementById('graphInput').value.trim();
            if (!input) return;
            
            addMessageToChat(`üìä –ì—Ä–∞—Ñ–∏–∫: ${input}`, 'user');
            
            try {
                const ctx = document.getElementById('graphCanvas').getContext('2d');
                const data = [];
                
                for (let x = -10; x <= 10; x += 0.1) {
                    try {
                        const y = math.evaluate(input.replace(/x/g, `(${x})`));
                        data.push({x, y});
                    } catch (e) {}
                }
                
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        datasets: [{
                            label: `f(x) = ${input}`,
                            data: data,
                            borderColor: '#8A2BE2',
                            backgroundColor: 'rgba(138, 43, 226, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        scales: {
                            x: { type: 'linear', position: 'bottom' },
                            y: { type: 'linear' }
                        }
                    }
                });
                
                addMessageToChat(`–ì—Ä–∞—Ñ–∏–∫ —Ñ—É–Ω–∫—Ü–∏–∏ ${input} —É—Å–ø–µ—à–Ω–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω!`, 'ai');
            } catch (error) {
                addMessageToChat("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é.", 'ai');
            }
        }

        function physicsCalculate() {
            const topic = document.getElementById('physicsSelect').value;
            addMessageToChat(`‚ö° –§–∏–∑–∏–∫–∞: ${topic}`, 'user');
            
            setTimeout(() => {
                const response = shamanAI.processPhysics({ topic });
                addMessageToChat(response, 'ai');
            }, 1000);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            initMatrix();
            
            document.getElementById('userInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Drag and drop –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            const uploadArea = document.querySelector('.upload-area');
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#FF1493';
                uploadArea.style.background = 'rgba(255, 20, 147, 0.2)';
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.style.borderColor = '#00CED1';
                uploadArea.style.background = '';
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#00CED1';
                uploadArea.style.background = '';
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleImageUpload(files[0]);
                }
            });
        });

        // –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
        window.addEventListener('resize', () => {
            const canvas = document.getElementById('matrixCanvas');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>
